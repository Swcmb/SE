<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.se.mapper.StudentMapper">

    <!-- 查询所有学生数据 -->
    <select id="selectAll" resultType="com.example.se.entity.Student">
        SELECT id, name, age, gender, email
        FROM student
    </select>

    <!-- 根据ID查询单个学生 -->
    <select id="selectById" parameterType="int" resultType="com.example.se.entity.Student">
        SELECT id, name, age, gender, email
        FROM student WHERE id = #{id}
    </select>

    <!-- 分页查询学生数据（支持按姓名查询） -->
    <select id="selectByPage" resultType="com.example.se.entity.Student">
        SELECT id, name, age, gender, email
        FROM student
        <where>
            <if test="name != null and name != ''">
                AND name LIKE CONCAT('%', #{name}, '%')
            </if>
        </where>
        ORDER BY id DESC
    </select>
    
    <!-- 新增学生 -->
    <insert id="insert" parameterType="com.example.se.entity.Student">
        INSERT INTO student(name, age, gender, email)
        VALUES (#{name}, #{age}, #{gender}, #{email})
    </insert>
    
    <!-- 更新学生信息 -->
    <update id="updateById" parameterType="com.example.se.entity.Student">
        UPDATE student
        <set>
            <if test="name != null and name != ''">
                name = #{name},
            </if>
            <if test="age != null">
                age = #{age},
            </if>
            <if test="gender != null and gender != ''">
                gender = #{gender},
            </if>
            <if test="email != null and email != ''">
                email = #{email},
            </if>
        </set>
        WHERE id = #{id}
    </update>
    
    <!-- 根据ID删除学生 -->
    <delete id="deleteById" parameterType="int">
        DELETE FROM student WHERE id = #{id}
    </delete>

</mapper>